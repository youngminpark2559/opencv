<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
   <HEAD>
      <TITLE>My first HTML document</TITLE>
      <style rel="stylesheet" type="text/css">
body {
 font-size: 23px;
 
 margin-top: 50px;
    margin-bottom: 50px;
    margin-right: 80px;
    margin-left: 80px;
    
    padding-top: 50px;
    padding-bottom: 50px;
    padding-right: 80px;
    padding-left: 80px;
    
    line-height:35px;
}
img {
 width:500px;
}
</style>
      <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    "HTML-CSS" : {
        availableFonts : ["STIX"],
        preferredFont : "STIX",
        webFont : "STIX-Web",
        imageFont : null
    }
});
</script>
     <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js" type="text/javascript">    
    MathJax.Hub.Config({
        HTML: ["input/TeX","output/HTML-CSS"],
        TeX: { extensions: ["AMSmath.js","AMSsymbols.js"], 
               equationNumbers: { autoNumber: "AMS" } },
        extensions: ["tex2jax.js"],
        jax: ["input/TeX","output/HTML-CSS"],
        tex2jax: { inlineMath: [ ['$$$','$$$'] ],
                   displayMath: [ ['$$$$','$$$$'] ],
                   processEscapes: true },
        "HTML-CSS": { availableFonts: ["TeX"],
                      linebreaks: { automatic: true } }
    });
</script>
   </HEAD>
   <BODY>
011 morphology operation, dilation, erosion, opening, closing, structuring element
<xmp>
011 morphology operation, dilation, erosion, opening, closing, structuring element

=========================================================
With image segmentation, there creates some issues

Distortion in small object and edge

So, you perform "morphology" to process raw image segmentation result image

=========================================================
Morphology operation : dilation, erosion

Advanced morphology operation from dilation, erosion : opening, closing

=========================================================
Morphology : study out of biolgy, which deals with shape and structure of animal and plant

You use mathematical morphology in image processing field

=========================================================
Why do you use mathematical morphology?

You use it as method which simplifies image segmentation result image to easier process "detecting object you're interested in"

Morphology can do "simplifying edge of object", "filling small hole", "removing small spine", resulting in shape of object simplified

=========================================================
Generally, you apply morphology to binary image and gray-scale image

=========================================================
Morphology filtering is similar to convolution,
which means you first define structuring element (which is equal to mask in convolution)

Operations are dilation and erosion (which are equal to convolution operation in convolution)

=========================================================
Set theory is needed to understand morphology

a is element of set A : a $$$\in$$$ A
a is not element of set A : a $$$\notin$$$ A
A is subset equal of B : A $$$\subseteq$$$ B

Union of A and B : $$$A\cup B$$$
Intersection of A and B : $$$A\cap B$$$
Complement of A : $$$A^{c}$$$
Difference of A and B : $$$A-B$$$

Reflection of A : $$$\dot{A}$$$ (symmetric move with criterion of (0,0))
2018-06-08 12-22-10.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-22-10.png"><xmp>
2018-06-08 12-22-28.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-22-28.png"><xmp>

Translation of A : $$$(A)_{z}$$$ z is composed of $$$z_{1}$$$ and $$$z_{2}$$$ (just move)
2018-06-08 12-23-15.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-23-15.png"><xmp>
2018-06-08 12-23-34.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-23-34.png"><xmp>

=========================================================
Dilation operation on binary image

This method is simplifying object with expanding object
So, 
small holes inside of object will be filled
2 near separated objects will be merged

$$$A\oplus B = \{z|(\dot{B}_{z} \cap A \neq \phi)\}$$$

A : set related to input image
B : set related to "structuring element",
which is small like mask
$$$\dot{B}$$$ : reflection of B (structuring element)
$$$\dot{B}_{z}$$$ : you move $$$\dot{B}$$$ as much as z
$$$\dot{B}_{z} \cap A$$$ : intersection of $$$\dot{B}_{z} \cap A$$$

communicative law
$$$A\oplus B = B\oplus A$$$

associative law
$$$A\oplus (B\oplus C) = (A\oplus B)\oplus C$$$

=========================================================
Actual algorithm

structuring element : green cross (structuring element can have other shapes like rectangle, ellipse, etc)
Center is 1, the others are 0
2018-06-08 12-41-03.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-41-03.png"><xmp>

Let's move structuring element to left with one step
You can see intersection part between structuring element and image (arrow)
2018-06-08 12-42-12.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-42-12.png"><xmp>

So, you will include blue part into output expanded image
Result:
2018-06-08 12-43-24.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-43-24.png"><xmp>

Let's move structuring element to up with one step
2018-06-08 12-44-09.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-44-09.png"><xmp>
2018-06-08 12-44-21.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-44-21.png"><xmp>

Let's move structuring element to left and up with each one step
2018-06-08 12-45-07.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-45-07.png"><xmp>

There is no intersection part

=========================================================
Dilation operation on example

structuring element (3by3 stuffed with 1, center is x) :
2018-06-08 12-55-29.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-55-29.png"><xmp>

original image :
2018-06-08 12-55-44.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-55-44.png"><xmp>

2018-06-08 12-56-39.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-56-39.png"><xmp>

Stuffing with 1:
2018-06-08 12-57-01.png 
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-57-01.png"><xmp>

2018-06-08 12-57-28.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-57-28.png"><xmp>

2018-06-08 12-57-41.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-57-41.png"><xmp>

After dilation :
2018-06-08 12-57-59.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-57-59.png"><xmp>

Stuffed holes
expanded object

=========================================================
Original image :
2018-06-08 12-58-56.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-58-56.png"><xmp>

Dilation with structuring element shaped rectangle (7by7)
2018-06-08 12-59-58.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 12-59-58.png"><xmp>

Dilation with structuring element shaped circle (7by7)
2018-06-08 13-00-07.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-00-07.png"><xmp>

=========================================================
Erosion operation

Reduces size of object
Performs erosion on edges of object
Removes small spines

$$$A\ominus B = \{z|B_{z}\subseteq A\}$$$

A : set related to image
B : set related to structuring element
$$$B_{z}$$$ : moves B as much as z
$$$B_{z}\subseteq A$$$ : $$$B_{z}$$$ should be involved in A, that parts will be included in result

2018-06-08 13-08-34.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-08-34.png"><xmp>

structuring element is not involved in image, so, center will be removed in result
2018-06-08 13-09-36.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-09-36.png"><xmp>

2018-06-08 13-09-55.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-09-55.png"><xmp>

2018-06-08 13-10-09.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-10-09.png"><xmp>

2018-06-08 13-10-24.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-10-24.png"><xmp>

=========================================================
Erosion on example

original image
2018-06-08 13-11-44.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-11-44.png"><xmp>

2018-06-08 13-12-06.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-12-06.png"><xmp>

result:
2018-06-08 13-12-29.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-12-29.png"><xmp>

=========================================================
2018-06-08 13-13-00.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-13-00.png"><xmp>
2018-06-08 13-13-20.png 
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-13-20.png"><xmp>

=========================================================
opening operation

erosion -> dilation
Removes small spine pixels of object

$$$ A\circ B = (A\ominus B)\oplus B$$$

2018-06-08 13-16-22.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-16-22.png"><xmp>

=========================================================
closing operation

dilation -> erosion
Fills small hole or gap pixels of object

$$$ A\cdot B = (A\oplus B)\ominus B$$$
2018-06-08 13-18-00.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-18-00.png"><xmp>

=========================================================
2018-06-08 13-18-39.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-18-39.png"><xmp>

=========================================================
Gray-scale image has brightness

So, structuring element can have level of brightness 
2018-06-08 13-25-13.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-25-13.png"><xmp>

=========================================================
Dilation of f by k
$$$(f\oplus k)(s,t)=max_{(s,t)\in D_{k}} \{f(x-s,y-t)+k(s,t)\}$$$

You will make largest value (most bright pixel) as result value

k(s,t) : value of structuring element
f(x-s,y-t) : refrection of f(x,y)

=========================================================
Erosion of f by k
$$$(f\ominus k)(s,t)=min_{(s,t)\in D_{k}} \{f(x+s,y+t)-k(s,t)\}$$$

You will make smallest value (less bright pixel) as result value

k(s,t) : value of structuring element
f(x+s,y+t) : refrection of f(x,y)

=========================================================
2018-06-08 13-41-57.png
</xmp><img src="https://raw.githubusercontent.com/youngmtool/opencv/master/sykim/pic/2018-06-08 13-41-57.png"><xmp>

</xmp>
   </BODY>
</HTML>
